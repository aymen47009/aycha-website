<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ğŸŒŸ ØµÙØ­ØªÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #fefafc;
      margin: 0;
      padding: 20px;
      color: #4a004a;
    }

    h1 {
      text-align: center;
      color: #a0007a;
    }

    .section {
      background-color: #fff0fa;
      padding: 20px;
      margin-bottom: 40px;
      border-radius: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .section h2 {
      color: #7a007a;
    }

    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }

    input, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 16px;
    }

    button {
      margin-top: 15px;
      background-color: #e7aaff;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    button:hover {
      background-color: #d98de5;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #fbd6ff;
    }

    #goalList li {
  background: #ffe4f4;
  padding: 10px;
  margin: 5px 0;
  border-radius: 10px;
  list-style: none;
  display: flex;
  align-items: center;
  gap: 10px;
}

#goalList input[type="checkbox"] {
  transform: scale(1.4);
}


.goal-item {
  background-color: #ffe4f4;
  border-radius: 10px;
  padding: 10px;
  margin-bottom: 10px;
  position: relative;
}

.goal-item span {
  display: block;
  margin-bottom: 5px;
}

.goal-item .countdown {
  color: #7a007a;
  font-weight: bold;
}

.goal-item button {
  background-color: #ffb3c6;
  margin-top: 10px;
}
  </style>
</head>
<body>

  <h1>ğŸŒŸ ØµÙØ­ØªÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© - Ø¹Ø§Ø¦Ø´Ø©</h1>

  <!-- ğŸ“˜ Ø§Ù„Ù‚Ø³Ù… 1: Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© -->
  <div class="section">
    <h2>ğŸ“˜ ÙˆØ§Ø¬Ø¨Ø§ØªÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</h2>
    <label>ğŸ“š Ø§Ù„Ù…Ø§Ø¯Ø©:</label>
    <input type="text" id="subject" placeholder="Ù…Ø«Ø§Ù„: Ø±ÙŠØ§Ø¶ÙŠØ§Øª" />

    <label>ğŸ“„ Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©:</label>
    <input type="text" id="page" placeholder="Ù…Ø«Ø§Ù„: 32" />

    <label>âœï¸ Ø±Ù‚Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†:</label>
    <input type="text" id="exercise" placeholder="Ù…Ø«Ø§Ù„: 3" />

    <label>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</label>
    <input type="date" id="hwDate" lang="en" style="direction: ltr;" />

    <label>ğŸ  Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</label>
    <input type="text" id="place" placeholder="Ù…Ø«Ø§Ù„: ÙÙŠ Ø§Ù„Ø¨ÙŠØª / ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" />

    <button onclick="saveHomework()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨</button>
    <p id="hwStatus"></p>
    <div id="homeworkList"></div>
  </div>

  <!-- ğŸ“– Ø§Ù„Ù‚Ø³Ù… 2: Ø¬Ø¯ÙˆÙ„ Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† -->
  <div class="section">
    <h2>ğŸ“– Ø¬Ø¯ÙˆÙ„ Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h2>
    <label>ğŸ“… Ø§Ù„ÙŠÙˆÙ…:</label>
    <input id="quranDay" placeholder="Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„ÙŠÙˆÙ…" />

    <label>ğŸ•‹ Ø§Ù„Ø³ÙˆØ±Ø©:</label>
    <input type="text" id="quranSurah" />

    <label>Ù…Ù† Ø§Ù„Ø¢ÙŠØ©:</label>
    <input type="text" id="quranFrom" />

    <label>Ø¥Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ©:</label>
    <input type="text" id="quranTo" />

    <label>Ù…Ù„Ø§Ø­Ø¸Ø©:</label>
    <textarea id="quranNote"></textarea>

    <button onclick="saveQuran()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­ÙØ¸</button>
    <p id="quranStatus"></p>
    <div id="quranList"></div>
  </div>

<!-- ğŸ¯ Ù‚Ø³Ù… Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© -->
<div class="section">
  <h2>ğŸ¯ Ø£Ù‡Ø¯Ø§ÙÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h2>

  <label>ğŸ¯ Ø§Ù„Ù‡Ø¯Ù:</label>
  <input type="text" id="goalText" placeholder="Ù…Ø«Ø§Ù„: Ø¥ØªÙ…Ø§Ù… Ø­ÙØ¸ Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ" />

  <label>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</label>
  <input type="datetime-local" id="goalDate" />

  <button onclick="saveGoal()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù‡Ø¯Ù</button>
  <p id="goalStatus"></p>

  <div id="goalList" style="margin-top: 20px;"></div>
</div>

  <!-- Flatpickr -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import {
      getFirestore, collection, addDoc, getDocs,
      query, orderBy, Timestamp, deleteDoc, doc
    } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDK3CqwJEB6uG8npPCG6jQqzqkUbI6vjJs",
      authDomain: "aycha-website.firebaseapp.com",
      projectId: "aycha-website",
      storageBucket: "aycha-website.appspot.com",
      messagingSenderId: "488063935676",
      appId: "1:488063935676:web:8a6450edd804d711db5cb9"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù„Ù„Ø³ÙˆØ±Ø©
    flatpickr("#quranDay", {
      dateFormat: "Y-m-d",
      locale: "en"
    });

    // âœ… ÙƒÙˆØ¯ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
    window.saveHomework = async function () {
      const subject = document.getElementById("subject").value.trim();
      const page = document.getElementById("page").value.trim();
      const exercise = document.getElementById("exercise").value.trim();
      const date = document.getElementById("hwDate").value;
      const place = document.getElementById("place").value.trim();
      const status = document.getElementById("hwStatus");

      if (!subject || !page || !exercise || !date || !place) {
        status.textContent = "âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.";
        status.style.color = "red";
        return;
      }

      try {
        await addDoc(collection(db, "profile", "aycha", "homework"), {
          subject, page, exercise, date, place, createdAt: Timestamp.now()
        });
        status.textContent = "âœ” ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨!";
        status.style.color = "green";
        showHomework();
      } catch (err) {
        console.error(err);
        status.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸.";
        status.style.color = "red";
      }
    }

    async function showHomework() {
  const container = document.getElementById("homeworkList");
  container.innerHTML = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
  const q = query(collection(db, "profile", "aycha", "homework"), orderBy("createdAt", "desc"));
  const snap = await getDocs(q);

  if (snap.empty) {
    container.innerHTML = "ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ø¹Ø¯.";
    return;
  }

  let html = `<table><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>Ø§Ù„ØµÙØ­Ø©</th><th>Ø§Ù„ØªÙ…Ø±ÙŠÙ†</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ù…ÙƒØ§Ù†</th><th>âŒ Ø­Ø°Ù</th></tr>`;
  snap.forEach(docSnap => {
    const d = docSnap.data();
    const id = docSnap.id;
    html += `<tr>
      <td>${d.subject}</td>
      <td>${d.page}</td>
      <td>${d.exercise}</td>
      <td>${d.date}</td>
      <td>${d.place}</td>
      <td><button onclick="deleteHomework('${id}')">ğŸ—‘ï¸</button></td>
    </tr>`;
  });
  html += "</table>";
  container.innerHTML = html;
}
 
window.deleteHomework = async function(id) {
  if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙˆØ§Ø¬Ø¨ØŸ")) {
    await deleteDoc(doc(db, "profile", "aycha", "homework", id));
    showHomework(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù
  }
}


    // âœ… ÙƒÙˆØ¯ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ÙØ¸
    window.saveQuran = async function () {
      const day = document.getElementById("quranDay").value;
      const surah = document.getElementById("quranSurah").value.trim();
      const from = document.getElementById("quranFrom").value.trim();
      const to = document.getElementById("quranTo").value.trim();
      const note = document.getElementById("quranNote").value.trim();
      const status = document.getElementById("quranStatus");

      if (!day || !surah || !from || !to) {
        status.textContent = "âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.";
        status.style.color = "red";
        return;
      }

      try {
        await addDoc(collection(db, "profile", "aycha", "quran"), {
          day, surah, from, to, note, createdAt: Timestamp.now()
        });
        status.textContent = "âœ” ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø­ÙØ¸!";
        status.style.color = "green";
        loadLastSurah();
        showQuran();
      } catch (err) {
        console.error(err);
        status.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸.";
        status.style.color = "red";
      }
    }

    async function loadLastSurah() {
      const q = query(collection(db, "profile", "aycha", "quran"), orderBy("createdAt", "desc"));
      const snap = await getDocs(q);
      if (!snap.empty) {
        const last = snap.docs[0].data();
        document.getElementById("quranSurah").value = last.surah;
      }
    }

    async function showQuran() {
  const container = document.getElementById("quranList");
  container.innerHTML = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
  const q = query(collection(db, "profile", "aycha", "quran"), orderBy("createdAt", "desc"));
  const snap = await getDocs(q);

  if (snap.empty) {
    container.innerHTML = "ğŸ“­ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ÙÙˆØ¸Ø§Øª.";
    return;
  }

  let html = `<table><tr><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„Ø³ÙˆØ±Ø©</th><th>Ù…Ù†</th><th>Ø¥Ù„Ù‰</th><th>Ù…Ù„Ø§Ø­Ø¸Ø©</th><th>âŒ Ø­Ø°Ù</th></tr>`;
  snap.forEach(docSnap => {
    const d = docSnap.data();
    const id = docSnap.id;
    html += `<tr>
      <td>${d.day}</td>
      <td>${d.surah}</td>
      <td>${d.from}</td>
      <td>${d.to}</td>
      <td>${d.note}</td>
      <td><button onclick="deleteQuran('${id}')">ğŸ—‘ï¸</button></td>
    </tr>`;
  });
  html += `</table>`;
  container.innerHTML = html;
}

window.deleteQuran = async function(id) {
  if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­ÙØ¸ØŸ")) {
    await deleteDoc(doc(db, "profile", "aycha", "quran", id));
    showQuran(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù
  }
}


    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    showHomework();
    showQuran();
    loadLastSurah();

    window.addGoal = function () {
  const input = document.getElementById("goalInput");
  const goalText = input.value.trim();
  if (goalText) {
    const ul = document.getElementById("goalList");
    const li = document.createElement("li");
    li.innerHTML = `<input type="checkbox" /> ${goalText}`;
    ul.appendChild(li);
    input.value = "";
  }
}


import { deleteDoc, doc, setDoc, getDocs, collection, Timestamp, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

window.saveGoal = async function () {
  const text = document.getElementById("goalText").value.trim();
  const date = document.getElementById("goalDate").value;
  const status = document.getElementById("goalStatus");

  if (!text || !date) {
    status.textContent = "âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‡Ø¯Ù ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø².";
    status.style.color = "red";
    return;
  }

  try {
    const goalId = Date.now().toString(); // ID Ù…Ø¤Ù‚Øª
    await setDoc(doc(db, "profile", "aycha", "goals", goalId), {
      text,
      date,
      createdAt: Timestamp.now()
    });
    status.textContent = "âœ” ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‡Ø¯Ù!";
    status.style.color = "green";
    showGoals();
  } catch (err) {
    status.textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸.";
    status.style.color = "red";
    console.error(err);
  }
}


window.deleteGoal = async function(id) {
  if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ÙŠÙ† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯ÙØŸ")) {
    await deleteDoc(doc(db, "profile", "aycha", "goals", id));
    showGoals();
  }
}

async function showGoals() {
  const container = document.getElementById("goalList");
  container.innerHTML = "â³ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù...";
  const q = query(collection(db, "profile", "aycha", "goals"), orderBy("createdAt", "desc"));
  const snap = await getDocs(q);

  if (snap.empty) {
    container.innerHTML = "ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‡Ø¯Ø§Ù Ø¨Ø¹Ø¯.";
    return;
  }

  let html = "";
  snap.forEach(docSnap => {
    const d = docSnap.data();
    const id = docSnap.id;
    const date = new Date(d.date);
    const now = new Date();
    const remaining = date - now;
    const countdownId = "countdown_" + id;

    html += `
      <div class="goal-item">
        <span>ğŸ¯ ${d.text}</span>
        <span>ğŸ“… Ø§Ù„Ù…ÙˆØ¹Ø¯: ${d.date}</span>
        <span class="countdown" id="${countdownId}">â³ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ...</span>
        <button onclick="deleteGoal('${id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
      </div>
    `;

    // Ù…Ø¤Ù‚Øª Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    setTimeout(() => {
      startCountdown(countdownId, new Date(d.date), d.text);
    }, 100);
  });

  container.innerHTML = html;
}

// â±ï¸ Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ + Ø¥Ø´Ø¹Ø§Ø±
function startCountdown(elementId, targetDate, goalText) {
  const el = document.getElementById(elementId);
  const interval = setInterval(() => {
    const now = new Date();
    const diff = targetDate - now;

    if (diff <= 0) {
      el.textContent = "â° ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆØ¹Ø¯!";
      sendNotification("Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ù‡Ø¯Ù ğŸ¯", `Ø§Ù„Ù‡Ø¯Ù: ${goalText}`);
      clearInterval(interval);
    } else {
      const hrs = Math.floor(diff / (1000 * 60 * 60));
      const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const secs = Math.floor((diff % (1000 * 60)) / 1000);
      el.textContent = `â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${hrs} Ø³ ${mins} Ø¯ ${secs} Ø«`;
    }
  }, 1000);
}

// ğŸ”” Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
function sendNotification(title, body) {
  if (Notification.permission === "granted") {
    new Notification(title, { body });
  } else if (Notification.permission !== "denied") {
    Notification.requestPermission().then(permission => {
      if (permission === "granted") {
        new Notification(title, { body });
      }
    });
  }
}

// ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
showGoals();

  </script>
</body>
</html>
